1.Формализация задачи
Вход: файл data.bin, содержащий последовательность вещественных чисел (double), хранящихся в бинарном виде.
Ограничения:
Размер файла ≥ 3 элемента (иначе преобразование не применимо).
Элементы имеют фиксированный размер: sizeof(double) = 8 байт.
Преобразование:Для всех i = 1..n-2 (0‑индексация)
Выход: файл data.bin перезаписан новыми значениями.

2. Алгоритм решения
Открыть файл в режиме чтения ("rb").
Определить количество элементов:
Переместиться в конец файла → fseek(f, 0, SEEK_END)
Получить размер → ftell(f)
Вычислить n = size / sizeof(double)
Проверить: если n < 3 → завершить (нечего обрабатывать).
Считать все элементы в динамический массив A.
Создать новый массив B:
B[0] = A[0]
B[n-1] = A[n-1]
Для i = 1 до n-2: B[i] = (A[i-1] + A[i] + A[i+1]) / 3.0
Перезаписать файл: открыть в режиме "wb", записать B.
Освободить память, закрыть файл.
Вывести сообщение об успешном завершении.

3. кодирование

// process_file.c
#include <stdio.h>
#include <stdlib.h>

int main() {
    const char* filename = "data.bin";
    FILE* f = fopen(filename, "rb");
    if (!f) {
        printf("Ошибка: не удалось открыть файл '%s' для чтения.\n", filename);
        return 1;
    }

    // Определяем количество элементов
    fseek(f, 0, SEEK_END);
    long file_size = ftell(f);
    int n = file_size / sizeof(double);
    fclose(f);

    if (n < 3) {
        printf("Файл содержит менее 3 элементов. Обработка не требуется.\n");
        return 0;
    }

    // Считываем данные
    double* A = (double*)malloc(n * sizeof(double));
    f = fopen(filename, "rb");
    fread(A, sizeof(double), n, f);
    fclose(f);

    // Создаём новый массив
    double* B = (double*)malloc(n * sizeof(double));
    B[0] = A[0];
    B[n - 1] = A[n - 1];
    for (int i = 1; i < n - 1; i++) {
        B[i] = (A[i - 1] + A[i] + A[i + 1]) / 3.0;
    }

    // Перезаписываем файл
    f = fopen(filename, "wb");
    fwrite(B, sizeof(double), n, f);
    fclose(f);

    free(A);
    free(B);
    printf("Файл '%s' успешно обработан. Всего элементов: %d\n", filename, n);
    return 0;
}







4.Программа для создания тестового файла
// create_test_file.c
#include <stdio.h>

int main() {
    double data[] = {1.0, 2.0, 3.0, 4.0, 5.0};
    int n = sizeof(data) / sizeof(data[0]);

    FILE* f = fopen("data.bin", "wb");
    fwrite(data, sizeof(double), n, f);
    fclose(f);

    printf("Тестовый файл 'data.bin' создан с %d элементами.\n", n);
    return 0;
}





